function chessinit(){chess.init()}var chess={Bishop:function(s,t){var i=new Object,e=document.createElement("div");return e.setAttribute("class","bishop"),e.setAttribute("color",s),e.setAttribute("index",t),e.setAttribute("id",s+"-"+t),e.style.backgroundImage="url('/2016/static/lacuna/img/puzzle/"+s+".png')",$(e).draggable({revert:!0,helper:"clone",opacity:.5}),i.html=e,i.color=s,i.index=t,i.getOpponents=function(){return 0==this.color?chess.bishops[1]:chess.bishops[0]},i.isValidMove=function(s){var t,i,e;return t=s.x-this.box.x,i=s.y-this.box.y,e=t/i,1==e||-1==e?1:0},i.isSafeMove=function(s){for(var t=0;2>t;t++)if(this.getOpponents()[t].isValidMove(s))return 0;return 1},i.makeMove=function(s){var t=.5*window.innerWidth;if(this.isSafeMove(s)&&this.isValidMove(s)&&!s.occupied){this.box.occupied=!1,this.box=s,this.box.occupied=!0,this.html.style.top=this.box.x*(.2*t),this.html.style.left=this.box.y*(.2*t);var i=this.color,e=this.index;return $("#"+i+"-"+e).css({top:this.box.x*(.2*t),left:this.box.y*(.2*t)}),1}return 0},i},Box:function(s,t){var i=new Object,e=document.createElement("div");return e.setAttribute("class","chess-box"),e.setAttribute("x",s),e.setAttribute("y",t),(s+t)%2==0?e.style.backgroundImage="url('/2016/static/lacuna/img/puzzle/black.jpg')":e.style.backgroundImage="url('/2016/static/lacuna/img/puzzle/white.jpg')",$(e).droppable({accept:".bishop",drop:function(s,t){var i=chess.bishops[t.draggable.attr("color")][t.draggable.attr("index")],e=chess.boxs[$(this).attr("x")][$(this).attr("y")];1==i.makeMove(e)&&($(".ui-draggable-dragging").hide(),chess.checkForVictory())}}),i.x=s,i.occupied=!1,i.y=t,i.html=e,i},createBoxs:function(){for(var s=document.getElementById("chess-board"),t=0;4>t;t++)for(var i=0;5>i;i++)this.boxs[t][i]=this.Box(t,i),s.appendChild(this.boxs[t][i].html)},createBishops:function(){for(var s=document.getElementById("chess-board"),t=0;2>t;t++)this.bishops[0][t]=this.Bishop(0,t),this.bishops[1][t]=this.Bishop(1,t),this.bishops[0][t].box=this.boxs[2*t+1][0],this.bishops[1][t].box=this.boxs[2*t+1][4],this.bishops[0][t].box.occupied=!0,this.bishops[1][t].box.occupied=!0,s.appendChild(this.bishops[1][t].html),s.appendChild(this.bishops[0][t].html)},checkForVictory:function(){for(var s=0;2>s;s++)if(this.bishops[0][s].box!=this.boxs[3][4]&&this.bishops[0][s].box!=this.boxs[1][4]||this.bishops[1][s].box!=this.boxs[1][0]&&this.bishops[1][s].box!=this.boxs[3][0])return 0;return submit_ans("win",1),1},setStyle:function(){var s=.5*window.innerWidth,t=window.innerHeight,i=document.getElementById("chess-board"),e=document.getElementsByClassName("chess-box");i.style.width=s,i.style.left=s/2,i.style.top=(t-.8*s)/2;for(var o=0;o<e.length;o++)e[o].style.height=.2*s,e[o].style.width=.2*s;$("#chess-board").css("width",s),$("#chess-board").css("left",s/2),$("#chess-board").css("top",(t-.8*s)/2),$(".chess-box").css("width",.2*s),$(".chess-box").css("height",.2*s);for(var o=0;2>o;o++)for(var h=0;2>h;h++)this.bishops[o][h].html.style.height=.2*s,this.bishops[o][h].html.style.width=.2*s,this.bishops[o][h].html.style.top=this.bishops[o][h].box.x*(.2*s),this.bishops[o][h].html.style.left=this.bishops[o][h].box.y*(.2*s),$("#"+o+"-"+h).css({width:.2*s,height:.2*s,top:this.bishops[o][h].box.x*(.2*s),left:this.bishops[o][h].box.y*(.2*s)})},initArrays:function(){this.boxs=new Array(5);for(var s=0;5>s;s++)this.boxs[s]=new Array(4);this.bishops=new Array(2);for(var s=0;2>s;s++)this.bishops[s]=new Array(2)},init:function(){this.initArrays(),this.createBoxs(),this.createBishops(),this.setStyle()}};